<div class="castrol-table-container mt-4">
  <div class="row">
    <button class="castrol-btn-color" (click)="abrirColorModal()">üé® Cambiar color</button>
  </div>
  <h2 class="castrol-table-title">Inventario</h2>
  <div class="mb-3">
    <button class="castrol-btn-add" (click)="abrirProductoModal()">Agregar Producto</button>
  </div>
  <div class="table-responsive">
     <table class="castrol-table">
      <thead>
        <tr>
          <th>#</th>
          <th>N√∫mero de parte</th>
          <th>Producto</th>
          <th>Precio</th>
          <th>Stock</th>
          <th>Categor√≠a</th>
          <th>Marca</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of inventario; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ item.part_number ?? '-' }}</td>
          <td>{{ item.product_name ?? '-' }}</td>
          <!-- Si quieres formateo MXN, descomenta la l√≠nea con currency y comenta la otra -->
          <!-- <td>{{ item.price | currency:'MXN':'symbol':'1.2-2' }}</td> -->
          <td>{{ item.price ?? '-' }}</td>
          <td>{{ item.stock ?? '-' }}</td>
          <td>{{ item.category_name ?? '-' }}</td>
          <td>{{ item.brand_name ?? '-' }}</td>
          <td class="acciones-cell">
            <div class="action-group">
              <button class="action-btn btn-edit" aria-label="Editar" data-tooltip="Editar" >
                <svg viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a1.004 1.004 0 0 0 0-1.42l-2.34-2.34a1.004 1.004 0 0 0-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.82z"/>
                </svg>
              </button>
              <button class="action-btn btn-delete" aria-label="Eliminar" data-tooltip="Eliminar">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M9 3h6l1 1h4v2H4V4h4l1-1zm1 7h2v8h-2v-8zm4 0h2v8h-2v-8zM6 7h12l-1 13a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2L6 7z"/>
                </svg>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    <p *ngIf="inventario.length === 0" class="text-muted text-center">
      No hay datos de inventario disponibles.
    </p>
  </div>
  <div class="color-modal-backdrop" *ngIf="colorModalAbierto" (click)="cerrarColorModal()"></div>
  <div class="color-modal" *ngIf="colorModalAbierto">
    <h4>Selecciona un color</h4>
    <div class="color-options">
      <div *ngFor="let color of colores" style="display: flex; flex-direction: column; align-items: center;">
        <button 
          [ngStyle]="{'background': color.value, 'color': '#fff'}"
          (click)="cambiarColor(color.value)">
        </button>
        <span style="margin-top: 3px; font-size: 0.80em;">{{color.nombre}}</span>
      </div>
    </div>
  <button class="castrol-btn-add" style="margin-top:1em;" (click)="cerrarColorModal()">Cerrar</button>
</div>

<div class="producto-modal" *ngIf="productoModalAbierto">
  <h2 class="producto-modal-title">Agregar producto</h2>
  <form autocomplete="off" (ngSubmit)="addProduct()" #formRef="ngForm">
    <div class="producto-form-grid">
      <div class="grid-col-span-2">
        <label>Marca</label>
        <select name="brand"
          [(ngModel)]="form.brand"
          required>
          <option [ngValue]="null" disabled>Selecciona marca</option>
          <option *ngFor="let brand of brands" [ngValue]="brand.id">
            {{brand.namee}}
          </option>
        </select>
      </div>
      <div>
        <label>Categor√≠a</label>
          <select name="category"
            [(ngModel)]="form.category"
            required>
          <option [ngValue]="null" disabled>Selecciona categor√≠a</option>
          <option *ngFor="let cat of categorys" [ngValue]="cat.id">
            {{cat.namee}}
          </option>
        </select>
      </div>
      <div class="grid-col-span-2">
        <label>N√∫mero de parte</label>
        <input type="text"
               name="partNumber"
               [(ngModel)]="form.partNumber"
               required>
      </div>

      <div class="grid-col-span-2">
        <label>Nombre</label>
        <input type="text"
               name="name"
               [(ngModel)]="form.name"
               required>
      </div>

      <div>
        <label>Precio</label>
        <input type="number"
               step="0.01"
               name="price"
               [(ngModel)]="form.price"
               required>
      </div>

      <div>
        <label>Stock</label>
        <input type="number"
               name="stock"
               [(ngModel)]="form.stock"
               min="0"
               required>
      </div>
    </div>

    <div class="producto-modal-actions">
      <button type="button" class="producto-cancel-btn" (click)="cerrarProductoModal()">Cancelar</button>
      <button type="submit" class="producto-save-btn" [disabled]="formRef.invalid">Guardar</button>
    </div>
  </form>
  </div>
</div>
